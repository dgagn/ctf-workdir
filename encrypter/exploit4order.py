#!/usr/bin/env python

from pwn import *
from itertools import product
import string
import multiprocessing as mp

valid_chars = string.ascii_letters[::-1] + string.digits[::-1]

data = "./log.txt"

def writeFlag(flag):
    f = open(data, "a")
    f.write(flag + '\n')
    f.close()

def do_job():
    for x in product(valid_chars, repeat = 8):
        possibleFlag = ''.join(x)
        r = process(['java', './Encrypter.java', possibleFlag])
        resp = r.recvall()
        print(resp)
        print(possibleFlag)
        r.close()
        if b"TRANSACTION" in resp:
            writeFlag(possibleFlag)
            writeFlag(resp)
            print(possibleFlag)
            break
        if b"FLAG" in resp:
            writeFlag(possibleFlag)
            writeFlag(resp)
            print(possibleFlag)
            break


def main():
    do_job()


if __name__ == "__main__":
    main()